self.addEventListener("push",i=>{console.log("[SW] Push received:",i);let o={};try{o=i.data?i.data.json():{}}catch(t){var n;console.error("[SW] Failed to parse push data:",t),o={title:"SoundChain",body:(null===(n=i.data)||void 0===n?void 0:n.text())||"You have a new notification"}}const{title:t="SoundChain",body:e="",icon:a,badge:c,url:l,tag:s,actions:d}=o,r={body:e,icon:a||"/icons/icon-192x192.png",badge:c||"/icons/badge-72x72.png",data:{url:l||"/dex/notifications"},tag:s||"soundchain-notification",vibrate:[100,50,100],requireInteraction:!1,actions:d||[]};i.waitUntil(self.registration.showNotification(t,r))}),self.addEventListener("notificationclick",i=>{var o;console.log("[SW] Notification clicked:",i),i.notification.close();const n=(null===(o=i.notification.data)||void 0===o?void 0:o.url)||"/dex/notifications";i.action&&console.log("[SW] Action clicked:",i.action),i.waitUntil(clients.matchAll({type:"window",includeUncontrolled:!0}).then(i=>{for(const o of i)if(o.url.includes(self.location.origin)&&"focus"in o)return o.navigate(n),o.focus();if(clients.openWindow)return clients.openWindow(n)}))}),self.addEventListener("notificationclose",i=>{console.log("[SW] Notification closed:",i)});